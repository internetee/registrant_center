{"version":3,"sources":["pages/CompaniesPage/CompaniesPage.jsx"],"names":["perPageOptions","key","text","value","connect","companies","ids","map","id","data","dispatch","bindActionCreators","fetchCompanies","fetchCompaniesAction","formatMessage","useIntl","useCookies","cookies","setCookie","companies_per_page","useState","Number","perPage","setPerPage","activePage","setActivePage","results","setResults","isLoading","setIsLoading","queryKeys","setQueryKeys","useEffect","companiesList","paginatedCompanies","length","copied","numOfChild","Math","ceil","i","push","splice","company","Row","Cell","name","registry_no","hasBackButton","titleKey","className","onSubmit","filteredCompanies","slice","query","toLowerCase","filter","includes","toString","defaultValue","disabled","onChange","event","placeholder","size","type","color","icon","onClick","primary","Header","HeaderCell","Body","firstItem","lastItem","nextItem","content","tagName","onPageChange","e","page","prevItem","totalPages","Field","inline","path","options","selection","headerContent"],"mappings":"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","file":"static/js/3.0f3bbd73.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n    Pagination,\n    Button,\n    Form,\n    Dropdown,\n    Icon,\n    Container,\n    Table,\n    Input,\n} from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { useCookies } from 'react-cookie';\nimport { bindActionCreators } from 'redux';\nimport { Loading, MainLayout, PageMessage } from '../../components';\nimport { fetchCompanies as fetchCompaniesAction } from '../../redux/reducers/companies';\n\nconst perPageOptions = [\n    { key: 6, text: '6', value: 6 },\n    { key: 12, text: '12', value: 12 },\n    { key: 24, text: '24', value: 24 },\n];\n\nconst CompaniesPage = ({ companies = [], fetchCompanies }) => {\n    const { formatMessage } = useIntl();\n    const [cookies, setCookie] = useCookies(['companies_per_page']);\n    const { companies_per_page } = cookies;\n    const [perPage, setPerPage] = useState(companies_per_page ? Number(companies_per_page) : 24);\n    const [activePage, setActivePage] = useState(1);\n    const [results, setResults] = useState(companies);\n    const [isLoading, setIsLoading] = useState(true);\n    const [queryKeys, setQueryKeys] = useState('');\n\n    useEffect(() => {\n        (async () => {\n            await fetchCompanies();\n            setIsLoading(false);\n        })();\n    }, [fetchCompanies]);\n\n    useEffect(() => {\n        setResults(companies);\n    }, [companies]);\n\n    const handlePageChange = (e, { activePage: page }) => {\n        setActivePage(page);\n    };\n\n    const handleItemsPerPage = (event, { value }) => {\n        setCookie('companies_per_page', value, { path: '/companies' });\n        setActivePage(1);\n        setPerPage(value);\n    };\n\n    const handleSearchChange = (event, { value }) => {\n        if (value === '') {\n            setResults(companies);\n        }\n        setQueryKeys(value);\n    };\n\n    const handleSearchReset = () => {\n        setActivePage(1);\n        setQueryKeys('');\n        setResults(companies);\n    };\n\n    const handleSearch = () => {\n        let filteredCompanies = companies.slice();\n        if (queryKeys.length) {\n            const query = queryKeys.toLowerCase();\n            filteredCompanies = filteredCompanies.filter(\n                (company) =>\n                    company.name.toLowerCase().includes(query) ||\n                    company.registry_no.toString().toLowerCase().includes(query)\n            );\n            setResults(filteredCompanies);\n        } else if (queryKeys.length === 0) {\n            setResults(companies);\n        }\n    };\n\n    if (isLoading) return <Loading />;\n    let companiesList = [];\n    const paginatedCompanies = [];\n\n    if (results && results.length) {\n        const copied = [...results];\n        const numOfChild = Math.ceil(copied.length / perPage);\n        for (let i = 0; i < numOfChild; i += 1) {\n            paginatedCompanies.push(copied.splice(0, perPage));\n        }\n        companiesList = paginatedCompanies[activePage - 1].map((company) => (\n            <Table.Row key={company.registry_no}>\n                <Table.Cell>{company.name}</Table.Cell>\n                <Table.Cell>{company.registry_no}</Table.Cell>\n            </Table.Row>\n        ));\n    }\n\n    return (\n        <MainLayout hasBackButton titleKey=\"companies.title\">\n            <div className=\"page page--companies\">\n                {companies.length ? (\n                    <>\n                        <div className=\"page--header\">\n                            <Container>\n                                <Form className=\"form-filter\" onSubmit={handleSearch}>\n                                    <div className=\"form-filter--search\">\n                                        <div className=\"form-filter--actions\">\n                                            {/* <Button as={Link} to={'/'} color='green'>Lisa uus</Button> */}\n                                        </div>\n                                        <div className=\"search-field\">\n                                            <Input\n                                                className=\"icon\"\n                                                defaultValue={queryKeys}\n                                                disabled={isLoading}\n                                                name=\"queryKeys\"\n                                                onChange={handleSearchChange}\n                                                placeholder={formatMessage({\n                                                    id: 'companies.searchForACompany',\n                                                })}\n                                                size=\"massive\"\n                                                type=\"text\"\n                                            />\n                                            <Button\n                                                color=\"orange\"\n                                                icon=\"sync\"\n                                                onClick={handleSearchReset}\n                                                type=\"reset\"\n                                            />\n                                            <Button icon=\"arrow right\" primary type=\"submit\" />\n                                        </div>\n                                        <div className=\"form-filter--actions\" />\n                                    </div>\n                                </Form>\n                            </Container>\n                        </div>\n                        {results ? (\n                            <>\n                                <Container>\n                                    <Table>\n                                        <Table.Header>\n                                            <Table.Row>\n                                                <Table.HeaderCell>\n                                                    <FormattedMessage id=\"companies.name\" />\n                                                </Table.HeaderCell>\n                                                <Table.HeaderCell>\n                                                    <FormattedMessage id=\"companies.registerCode\" />\n                                                </Table.HeaderCell>\n                                            </Table.Row>\n                                        </Table.Header>\n                                        <Table.Body>{companiesList}</Table.Body>\n                                    </Table>\n                                </Container>\n                                <div className=\"paginator\">\n                                    <Container>\n                                        <Pagination\n                                            activePage={activePage}\n                                            firstItem={null}\n                                            lastItem={null}\n                                            nextItem={{\n                                                content: (\n                                                    <>\n                                                        <FormattedMessage\n                                                            id=\"pagination.next\"\n                                                            tagName=\"span\"\n                                                        />\n                                                        <Icon name=\"arrow right\" />\n                                                    </>\n                                                ),\n                                                disabled: activePage === paginatedCompanies.length,\n                                                icon: true,\n                                            }}\n                                            onPageChange={handlePageChange}\n                                            prevItem={{\n                                                content: (\n                                                    <>\n                                                        <Icon name=\"arrow left\" />\n                                                        <FormattedMessage\n                                                            id=\"pagination.previous\"\n                                                            tagName=\"span\"\n                                                        />\n                                                    </>\n                                                ),\n                                                disabled: activePage === 1,\n                                                icon: true,\n                                            }}\n                                            totalPages={paginatedCompanies.length}\n                                        />\n                                        <Form>\n                                            <Form.Field inline>\n                                                <FormattedMessage\n                                                    id=\"pagination.perPage\"\n                                                    tagName=\"label\"\n                                                />\n                                                <Dropdown\n                                                    onChange={handleItemsPerPage}\n                                                    options={perPageOptions}\n                                                    selection\n                                                    value={perPage}\n                                                />\n                                            </Form.Field>\n                                        </Form>\n                                    </Container>\n                                </div>\n                            </>\n                        ) : (\n                            <PageMessage\n                                headerContent={\n                                    <FormattedMessage\n                                        id=\"companies.search.message.title\"\n                                        tagName=\"span\"\n                                    />\n                                }\n                            >\n                                <FormattedMessage\n                                    id=\"companies.search.message.content\"\n                                    tagName=\"p\"\n                                />\n                            </PageMessage>\n                        )}\n                    </>\n                ) : (\n                    <PageMessage\n                        headerContent={\n                            <FormattedMessage id=\"companies.none.message.title\" tagName=\"span\" />\n                        }\n                        icon=\"frown outline\"\n                    >\n                        <FormattedMessage id=\"companies.none.message.content\" tagName=\"p\" />\n                    </PageMessage>\n                )}\n            </div>\n        </MainLayout>\n    );\n};\n\nconst mapStateToProps = ({ companies }) => ({\n    companies: companies.ids.map((id) => companies.data[id]),\n});\n\nconst mapDispatchToProps = (dispatch) =>\n    bindActionCreators(\n        {\n            fetchCompanies: fetchCompaniesAction,\n        },\n        dispatch\n    );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CompaniesPage);\n\nCompaniesPage.propTypes = {\n    companies: PropTypes.array.isRequired,\n    fetchCompanies: PropTypes.func.isRequired,\n};\n"],"sourceRoot":""}